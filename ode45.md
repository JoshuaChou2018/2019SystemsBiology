<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css">
						<div class="htmledit_views" id="content_views">
                <h1 id="1%20%E7%AE%80%E4%BB%8B"><a name="t0"></a><span style="color:#000000;">1 简介</span></h1>

<p><span style="color:#000000;"><strong>&nbsp; &nbsp; &nbsp; ode45，常微分方程的数值求解。</strong></span><span style="color:#000000;">MATLAB提供了求常微分方程</span><span style="color:#000000;">数值解</span><span style="color:#000000;">的函数。当难以求得微分方程的解析解时，可以求其</span><span style="color:#000000;">数值解</span><span style="color:#000000;">（<strong>解析解</strong>就是给出解的</span><span style="color:#ff0000;">具体函数形式</span><span style="color:#000000;">，从解的表达式中就可以算出任何对应值；</span><span style="color:#000000;"><strong>数值解</strong></span><span style="color:#000000;">就是用数值方法</span><span style="color:#ff0000;">求出近似解</span><span style="color:#000000;">，给出一系列对应的自变量和解）。</span></p>

<p>&nbsp; &nbsp; &nbsp; &nbsp; Matlab中求微分方程数值解的函数有七个：ode45，ode23，ode113，ode15s，ode23s，ode23t，ode23tb 。</p>

<p><span style="color:#000000;">&nbsp; &nbsp; &nbsp; &nbsp; ode是Matlab专门用</span><span style="color:#000000;">于解</span><span style="color:#000000;">微分方程</span><span style="color:#000000;">的功能</span><span style="color:#000000;">函数。该求解器有</span><strong><span style="color:#ff0000;">变步长（variable-step）</span></strong><span style="color:#000000;">和</span><strong><span style="color:#ff0000;">定步长（fixed-step）</span></strong><span style="color:#000000;">两种类型。不同类型有着不同的求解器，其中ode45求解器属于</span><strong><span style="color:#000000;">变步长</span></strong><span style="color:#000000;">的一种，采用Runge-Kutta算法；其他采用相同算法的变步长求解器还有</span><span style="color:#000000;">ode23</span><span style="color:#000000;">。</span></p>

<p>&nbsp; &nbsp; &nbsp; &nbsp; ode45表示采用四阶-五阶Runge-Kutta算法，它用4阶方法提供候选解，5阶方法控制误差，是一种自适应步长（变步长）的常微分方程数值解法，其整体截断误差为(Δx)^5。解决的是Nonstiff(非刚性)常微分方程。</p>

<h1 id="2%20%E7%94%A8%E6%B3%95"><a name="t1"></a><span style="color:#000000;">2 用法</span></h1>

<p id="main-toc" style="text-indent:50px;"><strong>[T,Y] = ode45(odefun,tspan,y0)</strong></p>

<blockquote>
<ul><li><span style="color:#000000;">odefun 是函数句柄，可以是函数文件名，匿名函数句柄或内联函数名</span></li>
	<li><span style="color:#000000;">tspan 是区间 [t0 tf] 或者一系列散点[t0,t1,...,tf]</span></li>
	<li><span style="color:#000000;">y0 是初始值向量</span></li>
	<li><span style="color:#000000;">T 返回列向量的时间点</span></li>
	<li><span style="color:#000000;">Y 返回对应T的求解列向量</span></li>
</ul></blockquote>

<h1 id="3%20%E7%AE%97%E4%BE%8B"><a name="t2"></a><span style="color:#000000;">3 算例</span></h1>

<h3><a name="t3"></a><span style="color:#000000;">3.1 问题</span></h3>

<p><span style="color:#000000;">求解高阶常微分方程</span><span style="color:#000000;">：</span><span style="color:#000000;">&nbsp;</span><img alt="" class="has" height="19" src="https://gss2.bdstatic.com/-fo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D166/sign=6dd867bb8344ebf869716039eff8d736/30adcbef76094b36aa174555a7cc7cd98c109d84.jpg" width="166">&nbsp;</p>

<h3><a name="t4"></a><span style="color:#000000;">3.2 仿真程序</span></h3>

<pre class="has" name="code" onclick="hljs.copyCode(event)"><code class="hljs delphi"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Testode45</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-title">tspan</span>=[3.9 4.0]; %求解区间</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">y0=[<span class="hljs-number">8</span> <span class="hljs-number">2</span>]; %初值</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">[t,x]=ode45(@odefun,tspan,y0);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">plot(t,x(:,<span class="hljs-number">1</span>),<span class="hljs-string">'-o'</span>,t,x(:,<span class="hljs-number">2</span>),<span class="hljs-string">'-*'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">legend(<span class="hljs-string">'y1'</span>,<span class="hljs-string">'y2'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">title(<span class="hljs-string">'y'' ''=-t*y + e^t*y'' +3sin2t'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">xlabel(<span class="hljs-string">'t'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">ylabel(<span class="hljs-string">'y'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span>=<span class="hljs-title">odefun</span><span class="hljs-params">(t,x)</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-title">y</span>=<span class="hljs-title">zeros</span><span class="hljs-params">(2,1)</span>; % 列向量</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">y(<span class="hljs-number">1</span>)=x(<span class="hljs-number">2</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">y(<span class="hljs-number">2</span>)=-t*x(<span class="hljs-number">1</span>)+exp(t)*x(<span class="hljs-number">2</span>)+<span class="hljs-number">3</span>*sin(<span class="hljs-number">2</span>*t); %常微分方程公式</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">end</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">end</span></div></div></li></ol></code><div class="hljs-button" data-title="复制"></div></pre>

